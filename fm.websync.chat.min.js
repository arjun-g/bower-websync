
/*
 * Title: WebSync Client Chat Extension for JavaScript
 * Version: 4.8.8
 * Copyright Frozen Mountain Software 2011+
 */

!function(e,t,n){if("function"==typeof define&&define.amd)define(e,t,n);else if("object"==typeof exports){for(var s=0;s<t.length;s++)require("./"+t[s]);module.exports=n()}else this[e]=n()}("fm.websync.chat",["fm.websync.subscribers","fm","fm.websync"],function(){if("undefined"==typeof global||global.window||(global.window=global,global.document={cookie:""}),!window.fm)throw new Error("fm must be loaded before fm.websync.chat.");if(!window.fm.websync)throw new Error("fm.websync must be loaded before fm.websync.chat.");window.fm.websync.chat||(window.fm.websync.chat={}),fm.websync.chat.getVersion=function(){return"4.8.8"};var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function s(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return s.prototype=t.prototype,e.prototype=new s,e.__super__=t.prototype,e},n={}.hasOwnProperty;fm.websync.chat.userClientJoinArgs=function(n){function s(){this.getUserNickname=e(this.getUserNickname,this),this.getUserId=e(this.getUserId,this),this.getJoinedUser=e(this.getJoinedUser,this);var t,n,r;return 1===arguments.length&&fm.util.isPlainObject(arguments[0])?(n=s.__super__.constructor.call(this),fm.util.attachProperties(this,arguments[0]),n):(t=arguments[0],r=arguments[1],n=s.__super__.constructor.call(this,t,r))}return t(s,n),s.prototype.__joinedUser=null,s.prototype.__userId=null,s.prototype.__userNickname=null,s.prototype.getJoinedUser=function(){return this.__joinedUser},s.prototype.getUserId=function(){return this.__userId},s.prototype.getUserNickname=function(){return this.__userNickname},s}(fm.websync.subscribers.clientSubscribeArgs);var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function s(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return s.prototype=t.prototype,e.prototype=new s,e.__super__=t.prototype,e},n={}.hasOwnProperty;fm.websync.chat.userClientLeaveArgs=function(n){function s(){this.getUserNickname=e(this.getUserNickname,this),this.getUserId=e(this.getUserId,this),this.getLeftUser=e(this.getLeftUser,this);var t,n,r;return 1===arguments.length&&fm.util.isPlainObject(arguments[0])?(n=s.__super__.constructor.call(this),fm.util.attachProperties(this,arguments[0]),n):(t=arguments[0],r=arguments[1],n=s.__super__.constructor.call(this,t,r))}return t(s,n),s.prototype.__leftUser=null,s.prototype.__userId=null,s.prototype.__userNickname=null,s.prototype.getLeftUser=function(){return this.__leftUser},s.prototype.getUserId=function(){return this.__userId},s.prototype.getUserNickname=function(){return this.__userNickname},s}(fm.websync.subscribers.clientUnsubscribeArgs);var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function s(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return s.prototype=t.prototype,e.prototype=new s,e.__super__=t.prototype,e},n={}.hasOwnProperty;fm.websync.chat.chatClient=function(n){function s(){this.setClientId=e(this.setClientId,this),this.setBoundRecords=e(this.setBoundRecords,this),this.getClientId=e(this.getClientId,this),this.getBoundRecords=e(this.getBoundRecords,this);var t,n,r;return 1===arguments.length&&fm.util.isPlainObject(arguments[0])?(r=s.__super__.constructor.call(this),fm.util.attachProperties(this,arguments[0]),r):(n=arguments[0],t=arguments[1],r=s.__super__.constructor.call(this),this.__clientId=n,this.__boundRecords=t,r)}return t(s,n),s.prototype.__boundRecords=null,s.prototype.__clientId=null,s.prototype.getBoundRecords=function(){return this.__boundRecords},s.prototype.getClientId=function(){return this.__clientId},s.prototype.setBoundRecords=function(){var e;return e=arguments[0],this.setIsDirty(!0),this.__boundRecords=e},s.prototype.setClientId=function(){var e;return e=arguments[0],this.setIsDirty(!0),this.__clientId=e},s}(fm.serializable);var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function s(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return s.prototype=t.prototype,e.prototype=new s,e.__super__=t.prototype,e},n={}.hasOwnProperty;fm.websync.chat.chatUser=function(n){function s(){this.setUserNickname=e(this.setUserNickname,this),this.setUserId=e(this.setUserId,this),this.setClients=e(this.setClients,this),this.setClientId=e(this.setClientId,this),this.setBoundRecords=e(this.setBoundRecords,this),this.loadClientSet=e(this.loadClientSet,this),this.getUserNickname=e(this.getUserNickname,this),this.getUserId=e(this.getUserId,this),this.getClients=e(this.getClients,this),this.getClientId=e(this.getClientId,this),this.getBoundRecords=e(this.getBoundRecords,this);var t,n,r,i,o;return 1===arguments.length&&fm.util.isPlainObject(arguments[0])?(r=s.__super__.constructor.call(this),fm.util.attachProperties(this,arguments[0]),r):(i=arguments[0],o=arguments[1],n=arguments[2],t=arguments[3],r=s.__super__.constructor.call(this),this.setUserId(i),this.setUserNickname(o),this.__clientId=n,this.__boundRecords=t,r)}return t(s,n),s.prototype.__boundRecords=null,s.prototype.__clientId=null,s.prototype.__clients=null,s.prototype.__userId=null,s.prototype.__userNickname=null,s.prototype.getBoundRecords=function(){return this.__boundRecords},s.prototype.getClientId=function(){return this.__clientId},s.prototype.getClients=function(){return this.__clients},s.prototype.getUserId=function(){return this.__userId},s.prototype.getUserNickname=function(){return this.__userNickname},s.prototype.loadClientSet=function(){var e,t,n,s,r,i;for(t=arguments[0],r=[],e=fm.hashExtensions.getKeys(t),n=0,s=e.length;s>n;n++)i=e[n],fm.arrayExtensions.add(r,new fm.websync.chat.chatClient(fm.parseAssistant.parseGuidValue(i),t[i]));return this.setClients(fm.arrayExtensions.toArray(r))},s.prototype.setBoundRecords=function(){var e;return e=arguments[0],this.setIsDirty(!0),this.__boundRecords=e},s.prototype.setClientId=function(){var e;return e=arguments[0],this.setIsDirty(!0),this.__clientId=e},s.prototype.setClients=function(){var e;return e=arguments[0],this.setIsDirty(!0),this.__clients=e},s.prototype.setUserId=function(){var e;return e=arguments[0],this.setIsDirty(!0),this.__userId=e},s.prototype.setUserNickname=function(){var e;return e=arguments[0],this.setIsDirty(!0),this.__userNickname=e},s}(fm.serializable),fm.websync.chat.clientExtensions=function(){function e(){var t;return 1===arguments.length&&fm.util.isPlainObject(arguments[0])?(t=e.__super__.constructor.call(this),fm.util.attachProperties(this,arguments[0]),t):void 0}return e._argsKey=null,e._joinStateKey=null,e._leaveStateKey=null,e._userCacheKey=null,e._userCacheLockKey=null,e._userIdKey=null,e._userNicknameKey=null,e.getRecordValueJson=function(){var e,t;return t=arguments[0],e=arguments[1],fm.hashExtensions.containsKey(t,e)?t[e].getValueJson():null},e.getRecordValueJsonFromArray=function(){var e,t,n,s,r,i;for(i=arguments[0],n=arguments[1],e=i,t=0,s=e.length;s>t;t++)if(r=e[t],fm.global.equals(r.getKey(),n))return r.getValueJson();return null},e.getUser=function(){var e,t,n;return t=arguments[0],n=arguments[1],e=arguments[2],new fm.websync.chat.chatUser(fm.websync.chat.clientExtensions.getUserId(n,e),fm.websync.chat.clientExtensions.getUserNickname(n,e),t,n)},e.getUserId=function(){var e,t,n;return n=arguments[0],e=arguments[1],t=fm.websync.chat.clientExtensions.getRecordValueJson(n,fm.websync.chat.clientExtensions.getUserIdKey(e)),fm.global.equals(t,null)?null:fm.serializer.deserializeString(t)},e.getUserIdFromArray=function(){var e,t,n;return n=arguments[0],e=arguments[1],t=fm.websync.chat.clientExtensions.getRecordValueJsonFromArray(n,fm.websync.chat.clientExtensions.getUserIdKey(e)),fm.global.equals(t,null)?null:fm.serializer.deserializeString(t)},e.getUserIdKey=function(){var e;return e=arguments[0],fm.stringExtensions.concat(fm.websync.chat.clientExtensions._userIdKey,e)},e.getUserNickname=function(){var e,t,n;return n=arguments[0],e=arguments[1],t=fm.websync.chat.clientExtensions.getRecordValueJson(n,fm.websync.chat.clientExtensions.getUserNicknameKey(e)),fm.global.equals(t,null)?null:fm.serializer.deserializeString(t)},e.getUserNicknameFromArray=function(){var e,t,n;return n=arguments[0],e=arguments[1],t=fm.websync.chat.clientExtensions.getRecordValueJsonFromArray(n,fm.websync.chat.clientExtensions.getUserNicknameKey(e)),fm.global.equals(t,null)?null:fm.serializer.deserializeString(t)},e.getUserNicknameKey=function(){var e;return e=arguments[0],fm.stringExtensions.concat(fm.websync.chat.clientExtensions._userNicknameKey,e)},e.join=function(){var t,n,s,r,i,o;if(i=arguments[0],o=arguments[1],fm.stringExtensions.isNullOrEmpty(o.getChannel()))throw new Error("channel cannot be null.");if(fm.stringExtensions.isNullOrEmpty(o.getUserId()))throw new Error("userId cannot be null.");if(fm.stringExtensions.isNullOrEmpty(o.getUserNickname()))throw new Error("userNickname cannot be null.");return i.startBatch(),n=new fm.websync.bindArgs([new fm.websync.record(fm.websync.chat.clientExtensions.getUserIdKey(o.getChannel()),fm.serializer.serializeString(o.getUserId())),new fm.websync.record(fm.websync.chat.clientExtensions.getUserNicknameKey(o.getChannel()),fm.serializer.serializeString(o.getUserNickname()))]),n.setRequestUrl(o.getRequestUrl()),n.setRequestTimeout(o.getRequestTimeout()),n.setSynchronous(o.getSynchronous()),n.setOnSuccess(e.onBindSuccess),n.setOnFailure(e.onBindFailure),n.setDynamicProperties(o.getDynamicProperties()),r=n,r.setDynamicValue(fm.websync.chat.clientExtensions._argsKey,o),r.copyExtensions(o),i.bind(r),s=new fm.websync.subscribeArgs(o.getChannels(),o.getTag()),s.setRequestUrl(o.getRequestUrl()),s.setRequestTimeout(o.getRequestTimeout()),s.setSynchronous(o.getSynchronous()),s.setOnSuccess(e.onSubscribeSuccess),s.setOnFailure(e.onSubscribeFailure),s.setOnReceive(e.onReceive),s.setDynamicProperties(o.getDynamicProperties()),t=s,fm.websync.subscribers.subscribeArgsExtensions.setOnClientSubscribe(t,e.onClientSubscribe),fm.websync.subscribers.subscribeArgsExtensions.setOnClientUnsubscribe(t,e.onClientUnsubscribe),t.setDynamicValue(fm.websync.chat.clientExtensions._argsKey,o),t.copyExtensions(o),i.subscribe(t),o.setDynamicValue(fm.websync.chat.clientExtensions._userIdKey,o.getUserId()),o.setDynamicValue(fm.websync.chat.clientExtensions._userNicknameKey,o.getUserNickname()),i.endBatch(),i},e.leave=function(){var t,n,s,r,i,o;if(s=arguments[0],r=arguments[1],fm.stringExtensions.isNullOrEmpty(r.getChannel()))throw new Error("channel cannot be null.");return s.startBatch(),t=new fm.websync.unsubscribeArgs(r.getChannels(),r.getTag()),t.setRequestUrl(r.getRequestUrl()),t.setRequestTimeout(r.getRequestTimeout()),t.setSynchronous(r.getSynchronous()),t.setOnSuccess(e.onUnsubscribeSuccess),t.setOnFailure(e.onUnsubscribeFailure),t.setDynamicProperties(r.getDynamicProperties()),o=t,o.setDynamicValue(fm.websync.chat.clientExtensions._argsKey,r),o.copyExtensions(r),s.unsubscribe(o),n=new fm.websync.unbindArgs([new fm.websync.record(fm.websync.chat.clientExtensions.getUserIdKey(r.getChannel())),new fm.websync.record(fm.websync.chat.clientExtensions.getUserNicknameKey(r.getChannel()))]),n.setRequestUrl(r.getRequestUrl()),n.setRequestTimeout(r.getRequestTimeout()),n.setSynchronous(r.getSynchronous()),n.setOnSuccess(e.onUnbindSuccess),n.setOnFailure(e.onUnbindFailure),n.setDynamicProperties(r.getDynamicProperties()),i=n,i.setDynamicValue(fm.websync.chat.clientExtensions._argsKey,r),i.copyExtensions(r),s.unbind(i),s.endBatch(),s},e.onBindFailure=function(){var e,t,n;return e=arguments[0],t=e.getDynamicValue(fm.websync.chat.clientExtensions._argsKey),n=new fm.websync.chat.joinState,t.setDynamicValue(fm.websync.chat.clientExtensions._joinStateKey,n),n.updateBindFailure(e)},e.onBindSuccess=function(){var e,t,n;return e=arguments[0],t=e.getDynamicValue(fm.websync.chat.clientExtensions._argsKey),n=new fm.websync.chat.joinState,t.setDynamicValue(fm.websync.chat.clientExtensions._joinStateKey,n),n.updateBindSuccess(e),t.setDynamicValue(fm.websync.chat.clientExtensions._userIdKey,fm.websync.chat.clientExtensions.getUserIdFromArray(e.getRecords(),t.getChannel())),t.setDynamicValue(fm.websync.chat.clientExtensions._userNicknameKey,fm.websync.chat.clientExtensions.getUserNicknameFromArray(e.getRecords(),t.getChannel()))},e.onClientSubscribe=function(){var e,t;return e=arguments[0],t=e.getDynamicValue(fm.websync.chat.clientExtensions._argsKey),fm.websync.chat.clientExtensions.process(fm.websync.subscribers.subscriberChangeType.Subscribe,e.getSubscribedClient(),e.getChannel(),t,e,!0)},e.onClientUnsubscribe=function(){var e,t;return e=arguments[0],t=e.getDynamicValue(fm.websync.chat.clientExtensions._argsKey),fm.websync.chat.clientExtensions.process(fm.websync.subscribers.subscriberChangeType.Unsubscribe,e.getUnsubscribedClient(),e.getChannel(),t,e,!0)},e.onReceive=function(){var e,t,n,s,r,i,o,a,u,c;return n=arguments[0],o=n.getDynamicValue(fm.websync.chat.clientExtensions._argsKey),c=fm.websync.chat.clientExtensions.getUser(n.getPublishingClient().getClientId(),n.getPublishingClient().getBoundRecords(),o.getChannel()),null===n.getPublishingClient().getClientId()||fm.global.equals(c.getUserId(),null)||(r=o.getDynamicValue(fm.websync.chat.clientExtensions._userCacheKey),a=o.getDynamicValue(fm.websync.chat.clientExtensions._userCacheLockKey),fm.global.equals(r,null)||fm.global.equals(a,null)||(i=null,e=new fm.holder(i),t=fm.hashExtensions.tryGetValue(r,c.getUserId(),e),i=e.getValue(),t||(i=null),fm.global.equals(i,null)||c.loadClientSet(i))),s=new fm.websync.chat.joinReceiveArgs(n.getChannel(),n.getDataJson(),n.getDataBytes(),n.getConnectionType(),n.getReconnectAfter()),s.__publishingUser=c,s.__userId=o.getDynamicValue(fm.websync.chat.clientExtensions._userIdKey),s.__userNickname=o.getDynamicValue(fm.websync.chat.clientExtensions._userNicknameKey),s.setClient(n.getClient()),s.setTimestamp(n.getTimestamp()),s.setDynamicProperties(o.getDynamicProperties()),u=s,u.copyExtensions(n),o.getOnReceive()(u)},e.onSubscribeFailure=function(){var e,t,n;return e=arguments[0],t=e.getDynamicValue(fm.websync.chat.clientExtensions._argsKey),n=t.getDynamicValue(fm.websync.chat.clientExtensions._joinStateKey),t.unsetDynamicValue(fm.websync.chat.clientExtensions._joinStateKey),n.updateSubscribeFailure(e),n.getBindSuccess()?fm.websync.chat.clientExtensions.raiseJoinFailure(t,e,e.getIsResubscribe(),e.getChannels(),new Error(fm.stringExtensions.format("Join failed (bind succeeded, but subscribe failed [{0}]).",e.getException().message))):fm.websync.chat.clientExtensions.raiseJoinFailure(t,e,e.getIsResubscribe(),e.getChannels(),new Error(fm.stringExtensions.format("Join failed (bind failed [{0}] and subscribe failed [{1}]).",n.getBindFailureArgs().getException().message,e.getException().message)))},e.onSubscribeSuccess=function(){var e,t,n,s,r,i,o,a,u,c,l,h,p,g;if(n=arguments[0],o=n.getDynamicValue(fm.websync.chat.clientExtensions._argsKey),h=o.getDynamicValue(fm.websync.chat.clientExtensions._joinStateKey),o.unsetDynamicValue(fm.websync.chat.clientExtensions._joinStateKey),h.updateSubscribeSuccess(n),o.setDynamicValue(fm.websync.chat.clientExtensions._userCacheKey,{}),o.setDynamicValue(fm.websync.chat.clientExtensions._userCacheLockKey,new fm.object),h.getBindSuccess()){for(r=fm.websync.subscribers.subscribeSuccessArgsExtensions.getSubscribedClients(n)[n.getChannel()],i={},e=r,a=0,c=e.length;c>a;a++)s=e[a],p=fm.websync.chat.clientExtensions.process(fm.websync.subscribers.subscriberChangeType.Subscribe,s,n.getChannel(),o,n,!1),fm.global.equals(p,null)||(i[p.getUserId()]=p);for(g=[],t=fm.hashExtensions.getValues(i),u=0,l=t.length;l>u;u++)p=t[u],fm.arrayExtensions.add(g,p);return fm.websync.chat.clientExtensions.raiseJoinSuccess(o,n,g)}return fm.websync.chat.clientExtensions.raiseJoinFailure(o,h.getBindFailureArgs(),n.getIsResubscribe(),n.getChannels(),new Error(fm.stringExtensions.format("Join failed (subscribe succeeded, but bind failed [{0}]).",h.getBindFailureArgs().getException().message)))},e.onUnbindFailure=function(){var e,t,n;return e=arguments[0],t=e.getDynamicValue(fm.websync.chat.clientExtensions._argsKey),n=t.getDynamicValue(fm.websync.chat.clientExtensions._leaveStateKey),t.unsetDynamicValue(fm.websync.chat.clientExtensions._leaveStateKey),n.updateUnbindFailure(e),n.getUnsubscribeSuccess()?fm.websync.chat.clientExtensions.raiseLeaveFailure(t,e,n.getUnsubscribeSuccessArgs().getChannels(),new Error(fm.stringExtensions.format("Leave failed (unsubscribe succeeded, but unbind failed [{0}]).",e.getException().message))):fm.websync.chat.clientExtensions.raiseLeaveFailure(t,e,n.getUnsubscribeFailureArgs().getChannels(),new Error(fm.stringExtensions.format("Leave failed (unsubscribe failed [{0}] and unbind failed [{1}]).",n.getUnsubscribeFailureArgs().getException().message,e.getException().message)))},e.onUnbindSuccess=function(){var e,t,n;return e=arguments[0],t=e.getDynamicValue(fm.websync.chat.clientExtensions._argsKey),n=t.getDynamicValue(fm.websync.chat.clientExtensions._leaveStateKey),t.unsetDynamicValue(fm.websync.chat.clientExtensions._leaveStateKey),n.updateUnbindSuccess(e),t.setDynamicValue(fm.websync.chat.clientExtensions._userIdKey,fm.websync.chat.clientExtensions.getUserIdFromArray(e.getRecords(),t.getChannel())),t.setDynamicValue(fm.websync.chat.clientExtensions._userNicknameKey,fm.websync.chat.clientExtensions.getUserNicknameFromArray(e.getRecords(),t.getChannel())),n.getUnsubscribeSuccess()?fm.websync.chat.clientExtensions.raiseLeaveSuccess(t,n.getUnsubscribeSuccessArgs()):fm.websync.chat.clientExtensions.raiseLeaveFailure(t,n.getUnsubscribeFailureArgs(),n.getUnsubscribeFailureArgs().getChannels(),new Error(fm.stringExtensions.format("Leave failed (unbind succeeded, but unsubscribe failed [{0}]).",n.getUnsubscribeFailureArgs().getException().message)))},e.onUnsubscribeFailure=function(){var e,t,n;return e=arguments[0],t=e.getDynamicValue(fm.websync.chat.clientExtensions._argsKey),n=new fm.websync.chat.leaveState,t.setDynamicValue(fm.websync.chat.clientExtensions._leaveStateKey,n),n.updateUnsubscribeFailure(e)},e.onUnsubscribeSuccess=function(){var e,t,n;return e=arguments[0],t=e.getDynamicValue(fm.websync.chat.clientExtensions._argsKey),n=new fm.websync.chat.leaveState,t.setDynamicValue(fm.websync.chat.clientExtensions._leaveStateKey,n),n.updateUnsubscribeSuccess(e)},e.process=function(){var e,t,n,s,r,i,o,a,u,c,l,h,p,g,m,f,y,d,b,_,v,w,C,R,S,O,x,E;return x=arguments[0],O=arguments[1],h=arguments[2],d=arguments[3],R=arguments[4],m=arguments[5],g=d.getDynamicValue(fm.websync.chat.clientExtensions._userCacheKey),b=d.getDynamicValue(fm.websync.chat.clientExtensions._userCacheLockKey),fm.global.equals(g,null)||fm.global.equals(b,null)?null:(E=fm.websync.chat.clientExtensions.getUser(O.getClientId(),O.getBoundRecords(),d.getChannel()),fm.global.equals(E.getUserId(),null)?(fm.global.equals(x,fm.websync.subscribers.subscriberChangeType.Subscribe)?fm.log.warn("A remote client subscribed but a user ID was not bound. Is the remote client using the Chat extension, or did they leave multiple times?"):fm.log.warn("A remote client unsubscribed but a user ID was not bound. Is the remote client using the Chat extension, or did they leave multiple times?"),null):fm.global.equals(E.getUserId(),d.getDynamicValue(fm.websync.chat.clientExtensions._userIdKey))?null:fm.global.equals(x,fm.websync.subscribers.subscriberChangeType.Subscribe)?(f=!1,p=null,e=new fm.holder(p),t=fm.hashExtensions.tryGetValue(g,E.getUserId(),e),p=e.getValue(),t||(p={}),p[O.getClientId().toString()]=O.getBoundRecords(),f=fm.global.equals(fm.hashExtensions.getCount(p),1),E.loadClientSet(p),f&&(g[E.getUserId()]=p),f&&(w=d.getOnUserJoin(),m&&!fm.global.equals(w,null)&&(r=new fm.websync.chat.userJoinArgs(h,O),r.__joinedUser=E,r.__userId=d.getDynamicValue(fm.websync.chat.clientExtensions._userIdKey),r.__userNickname=d.getDynamicValue(fm.websync.chat.clientExtensions._userNicknameKey),r.setClient(R.getClient()),r.setTimestamp(R.getTimestamp()),r.setDynamicProperties(R.getDynamicProperties()),S=r,S.copyExtensions(R),w(S))),m&&(_=d.getOnUserClientJoin(),fm.global.equals(_,null)||(o=new fm.websync.chat.userClientJoinArgs(h,O),o.__joinedUser=E,o.__userId=d.getDynamicValue(fm.websync.chat.clientExtensions._userIdKey),o.__userNickname=d.getDynamicValue(fm.websync.chat.clientExtensions._userNicknameKey),o.setClient(R.getClient()),o.setTimestamp(R.getTimestamp()),o.setDynamicProperties(R.getDynamicProperties()),i=o,i.copyExtensions(R),_(i))),E):(y=!1,p=null,n=new fm.holder(p),s=fm.hashExtensions.tryGetValue(g,E.getUserId(),n),p=n.getValue(),s?(E.loadClientSet(p),fm.hashExtensions.remove(p,O.getClientId().toString()),y=fm.global.equals(fm.hashExtensions.getCount(p),0),y&&fm.hashExtensions.remove(g,E.getUserId()),m&&(v=d.getOnUserClientLeave(),fm.global.equals(v,null)||(u=new fm.websync.chat.userClientLeaveArgs(h,O),u.__leftUser=E,u.__userId=d.getDynamicValue(fm.websync.chat.clientExtensions._userIdKey),u.__userNickname=d.getDynamicValue(fm.websync.chat.clientExtensions._userNicknameKey),u.setClient(R.getClient()),u.setTimestamp(R.getTimestamp()),u.setDynamicProperties(R.getDynamicProperties()),a=u,a.copyExtensions(R),v(a))),y&&(C=d.getOnUserLeave(),m&&!fm.global.equals(C,null)&&(l=new fm.websync.chat.userLeaveArgs(h,O),l.__leftUser=E,l.__userId=d.getDynamicValue(fm.websync.chat.clientExtensions._userIdKey),l.__userNickname=d.getDynamicValue(fm.websync.chat.clientExtensions._userNicknameKey),l.setClient(R.getClient()),l.setTimestamp(R.getTimestamp()),l.setDynamicProperties(R.getDynamicProperties()),c=l,c.copyExtensions(R),C(c))),E):(fm.log.debug("Unsubscribe notification received, but no user associated with the client ID was found."),null)))},e.raiseJoinFailure=function(){var e,t,n,s,r,i,o,a,u,c,l,h,p,g,m,f,y;if(p=arguments[0],e=arguments[1],h=arguments[2],r=arguments[3],a=arguments[4],y=!1,m=p.getOnFailure(),!fm.global.equals(m,null)){t=new fm.websync.chat.joinFailureArgs,t.__channels=r,t.__userId=p.getDynamicValue(fm.websync.chat.clientExtensions._userIdKey),t.__userNickname=p.getDynamicValue(fm.websync.chat.clientExtensions._userNicknameKey),t.__isRejoin=h,t.setRetry(e.getRetry()),t.setClient(e.getClient()),t.setException(a),t.setTimestamp(e.getTimestamp()),t.setDynamicProperties(p.getDynamicProperties()),f=t,f.copyExtensions(e);try{m(f)}catch(i){u=i,c=u,e.getClient().raiseUnhandledException(c)||fm.asyncException.asyncThrow(c,"Client -> Join -> OnFailure")}finally{}y=f.getRetry()}if(g=p.getOnComplete(),!fm.global.equals(g,null)){s=new fm.websync.chat.joinCompleteArgs,s.__isRejoin=h,s.setClient(e.getClient()),s.setTimestamp(e.getTimestamp()),s.setDynamicProperties(p.getDynamicProperties()),n=s,n.copyExtensions(e);try{g(n)}catch(o){l=o,c=l,e.getClient().raiseUnhandledException(c)||fm.asyncException.asyncThrow(c,"Client -> Join -> OnComplete")}finally{}}return y?(p.setIsRetry(!0),fm.websync.chat.clientExtensions.join(e.getClient(),p)):void 0},e.raiseJoinSuccess=function(){var e,t,n,s,r,i,o,a,u,c,l,h,p,g;if(c=arguments[0],e=arguments[1],g=arguments[2],h=c.getOnSuccess(),!fm.global.equals(h,null)){t=new fm.websync.chat.joinSuccessArgs,t.__channels=e.getChannels(),t.__userId=c.getDynamicValue(fm.websync.chat.clientExtensions._userIdKey),t.__userNickname=c.getDynamicValue(fm.websync.chat.clientExtensions._userNicknameKey),t.__users=fm.arrayExtensions.toArray(g),t.__isRejoin=e.getIsResubscribe(),t.setClient(e.getClient()),t.setTimestamp(e.getTimestamp()),t.setDynamicProperties(c.getDynamicProperties()),p=t,p.copyExtensions(e);try{h(p)}catch(r){a=r,o=a,e.getClient().raiseUnhandledException(o)||fm.asyncException.asyncThrow(o,"Client -> Join -> OnSuccess")}finally{}}if(l=c.getOnComplete(),!fm.global.equals(l,null)){s=new fm.websync.chat.joinCompleteArgs,s.__isRejoin=e.getIsResubscribe(),s.setClient(e.getClient()),s.setTimestamp(e.getTimestamp()),s.setDynamicProperties(c.getDynamicProperties()),n=s,n.copyExtensions(e);try{return l(n)}catch(i){if(u=i,o=u,!e.getClient().raiseUnhandledException(o))return fm.asyncException.asyncThrow(o,"Client -> Join -> OnComplete")}finally{}}},e.raiseLeaveFailure=function(){var e,t,n,s,r,i,o,a,u,c,l,h,p,g,m,f;if(h=arguments[0],e=arguments[1],r=arguments[2],a=arguments[3],f=!1,g=h.getOnFailure(),!fm.global.equals(g,null)){t=new fm.websync.chat.leaveFailureArgs,t.__channels=r,t.__userId=fm.global.tryCastString(h.getDynamicValue(fm.websync.chat.clientExtensions._userIdKey)),t.__userNickname=fm.global.tryCastString(h.getDynamicValue(fm.websync.chat.clientExtensions._userNicknameKey)),t.setRetry(e.getRetry()),t.setClient(e.getClient()),t.setException(a),t.setTimestamp(e.getTimestamp()),t.setDynamicProperties(h.getDynamicProperties()),m=t,m.copyExtensions(e);try{g(m)}catch(i){u=i,c=u,e.getClient().raiseUnhandledException(c)||fm.asyncException.asyncThrow(c,"Client -> Leave -> OnFailure")}finally{}f=m.getRetry()}if(p=h.getOnComplete(),!fm.global.equals(p,null)){s=new fm.websync.chat.leaveCompleteArgs,s.setClient(e.getClient()),s.setTimestamp(e.getTimestamp()),s.setDynamicProperties(h.getDynamicProperties()),n=s,n.copyExtensions(e);try{p(n)}catch(o){l=o,c=l,e.getClient().raiseUnhandledException(c)||fm.asyncException.asyncThrow(c,"Client -> Leave -> OnComplete")}finally{}}return f?(h.setIsRetry(!0),fm.websync.chat.clientExtensions.leave(e.getClient(),h)):void 0},e.raiseLeaveSuccess=function(){var e,t,n,s,r,i,o,a,u,c,l,h,p;if(c=arguments[0],e=arguments[1],h=c.getOnSuccess(),!fm.global.equals(h,null)){t=new fm.websync.chat.leaveSuccessArgs,t.__channels=e.getChannels(),t.__userId=c.getDynamicValue(fm.websync.chat.clientExtensions._userIdKey),t.__userNickname=c.getDynamicValue(fm.websync.chat.clientExtensions._userNicknameKey),t.setClient(e.getClient()),t.setTimestamp(e.getTimestamp()),t.setDynamicProperties(c.getDynamicProperties()),p=t,p.copyExtensions(e);try{h(p)}catch(r){a=r,o=a,e.getClient().raiseUnhandledException(o)||fm.asyncException.asyncThrow(o,"Client -> Leave -> OnSuccess")}finally{}}if(l=c.getOnComplete(),!fm.global.equals(l,null)){s=new fm.websync.chat.leaveCompleteArgs,s.setClient(e.getClient()),s.setTimestamp(e.getTimestamp()),s.setDynamicProperties(c.getDynamicProperties()),n=s,n.copyExtensions(e);try{return l(n)}catch(i){if(u=i,o=u,!e.getClient().raiseUnhandledException(o))return fm.asyncException.asyncThrow(o,"Client -> Leave -> OnComplete")}finally{}}},e.getRecordValue=function(){var t,n;return n=arguments[0],t=arguments[1],fm.json.deserialize(e.getRecordValueJson.apply(e,arguments))},fm.websync.client.prototype.join=function(){var e;return e=arguments[0],Array.prototype.splice.call(arguments,0,0,this),fm.websync.chat.clientExtensions.join.apply(this,arguments)},fm.websync.client.prototype.leave=function(){var e;return e=arguments[0],Array.prototype.splice.call(arguments,0,0,this),fm.websync.chat.clientExtensions.leave.apply(this,arguments)},e._userIdKey="fm.chat.userId",e._userNicknameKey="fm.chat.userNickname",e._userCacheKey="fm.chat.userCache",e._userCacheLockKey="fm.chat.userCacheLock",e._joinStateKey="fm.chat.joinState",e._leaveStateKey="fm.chat.leaveState",e._argsKey="fm.chat.args",e}();var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function s(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return s.prototype=t.prototype,e.prototype=new s,e.__super__=t.prototype,e},n={}.hasOwnProperty;fm.websync.chat.leaveState=function(n){function s(){this.updateUnsubscribeSuccess=e(this.updateUnsubscribeSuccess,this),this.updateUnsubscribeFailure=e(this.updateUnsubscribeFailure,this),this.updateUnbindSuccess=e(this.updateUnbindSuccess,this),this.updateUnbindFailure=e(this.updateUnbindFailure,this),this.setUnsubscribeSuccessArgs=e(this.setUnsubscribeSuccessArgs,this),this.setUnsubscribeSuccess=e(this.setUnsubscribeSuccess,this),this.setUnsubscribeFailureArgs=e(this.setUnsubscribeFailureArgs,this),this.setUnbindSuccessArgs=e(this.setUnbindSuccessArgs,this),this.setUnbindSuccess=e(this.setUnbindSuccess,this),this.setUnbindFailureArgs=e(this.setUnbindFailureArgs,this),this.getUnsubscribeSuccessArgs=e(this.getUnsubscribeSuccessArgs,this),this.getUnsubscribeSuccess=e(this.getUnsubscribeSuccess,this),this.getUnsubscribeFailureArgs=e(this.getUnsubscribeFailureArgs,this),this.getUnbindSuccessArgs=e(this.getUnbindSuccessArgs,this),this.getUnbindSuccess=e(this.getUnbindSuccess,this),this.getUnbindFailureArgs=e(this.getUnbindFailureArgs,this);var t;return 1===arguments.length&&fm.util.isPlainObject(arguments[0])?(t=s.__super__.constructor.call(this),fm.util.attachProperties(this,arguments[0]),t):t=s.__super__.constructor.call(this)}return t(s,n),s.prototype._unbindFailureArgs=null,s.prototype._unbindSuccess=!1,s.prototype._unbindSuccessArgs=null,s.prototype._unsubscribeFailureArgs=null,s.prototype._unsubscribeSuccess=!1,s.prototype._unsubscribeSuccessArgs=null,s.prototype.getUnbindFailureArgs=function(){return this._unbindFailureArgs},s.prototype.getUnbindSuccess=function(){return this._unbindSuccess},s.prototype.getUnbindSuccessArgs=function(){return this._unbindSuccessArgs},s.prototype.getUnsubscribeFailureArgs=function(){return this._unsubscribeFailureArgs},s.prototype.getUnsubscribeSuccess=function(){return this._unsubscribeSuccess},s.prototype.getUnsubscribeSuccessArgs=function(){return this._unsubscribeSuccessArgs},s.prototype.setUnbindFailureArgs=function(){var e;return e=arguments[0],this._unbindFailureArgs=e},s.prototype.setUnbindSuccess=function(){var e;return e=arguments[0],this._unbindSuccess=e},s.prototype.setUnbindSuccessArgs=function(){var e;return e=arguments[0],this._unbindSuccessArgs=e},s.prototype.setUnsubscribeFailureArgs=function(){var e;return e=arguments[0],this._unsubscribeFailureArgs=e},s.prototype.setUnsubscribeSuccess=function(){var e;return e=arguments[0],this._unsubscribeSuccess=e},s.prototype.setUnsubscribeSuccessArgs=function(){var e;return e=arguments[0],this._unsubscribeSuccessArgs=e},s.prototype.updateUnbindFailure=function(){var e;return e=arguments[0],this.setUnbindSuccess(!1),this.setUnbindFailureArgs(e)},s.prototype.updateUnbindSuccess=function(){var e;return e=arguments[0],this.setUnbindSuccess(!0),this.setUnbindSuccessArgs(e)},s.prototype.updateUnsubscribeFailure=function(){var e;return e=arguments[0],this.setUnsubscribeSuccess(!1),this.setUnsubscribeFailureArgs(e)},s.prototype.updateUnsubscribeSuccess=function(){var e;return e=arguments[0],this.setUnsubscribeSuccess(!0),this.setUnsubscribeSuccessArgs(e)},s}(fm.object);var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function s(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return s.prototype=t.prototype,e.prototype=new s,e.__super__=t.prototype,e},n={}.hasOwnProperty;fm.websync.chat.joinArgs=function(n){function s(){this.setUserNickname=e(this.setUserNickname,this),this.setUserId=e(this.setUserId,this),this.setTag=e(this.setTag,this),this.setRejoin=e(this.setRejoin,this),this.setOnUserLeave=e(this.setOnUserLeave,this),this.setOnUserJoin=e(this.setOnUserJoin,this),this.setOnUserClientLeave=e(this.setOnUserClientLeave,this),this.setOnUserClientJoin=e(this.setOnUserClientJoin,this),this.setOnSuccess=e(this.setOnSuccess,this),this.setOnReceive=e(this.setOnReceive,this),this.setOnFailure=e(this.setOnFailure,this),this.setOnComplete=e(this.setOnComplete,this),this.setChannels=e(this.setChannels,this),this.setChannel=e(this.setChannel,this),this.getUserNickname=e(this.getUserNickname,this),this.getUserId=e(this.getUserId,this),this.getTag=e(this.getTag,this),this.getRejoin=e(this.getRejoin,this),this.getOnUserLeave=e(this.getOnUserLeave,this),this.getOnUserJoin=e(this.getOnUserJoin,this),this.getOnUserClientLeave=e(this.getOnUserClientLeave,this),this.getOnUserClientJoin=e(this.getOnUserClientJoin,this),this.getOnSuccess=e(this.getOnSuccess,this),this.getOnReceive=e(this.getOnReceive,this),this.getOnFailure=e(this.getOnFailure,this),this.getOnComplete=e(this.getOnComplete,this),this.getChannels=e(this.getChannels,this),this.getChannel=e(this.getChannel,this);var t,n,r;return 1===arguments.length&&fm.util.isPlainObject(arguments[0])?(n=s.__super__.constructor.call(this),
fm.util.attachProperties(this,arguments[0]),n):2===arguments.length?(t=arguments[0],r=arguments[1],n=s.__super__.constructor.call(this),this.setChannels(t),this.setTag(r),n):1===arguments.length?(t=arguments[0],n=s.__super__.constructor.call(this),this.setChannels(t),n):void 0}return t(s,n),s.prototype.__channels=null,s.prototype._onComplete=null,s.prototype._onFailure=null,s.prototype._onReceive=null,s.prototype._onSuccess=null,s.prototype._onUserClientJoin=null,s.prototype._onUserClientLeave=null,s.prototype._onUserJoin=null,s.prototype._onUserLeave=null,s.prototype._rejoin=!1,s.prototype._userId=null,s.prototype._userNickname=null,s.prototype.getChannel=function(){return fm.websync.extensible.sharedGetChannel(this.__channels)},s.prototype.getChannels=function(){return fm.websync.extensible.sharedGetChannels(this.__channels)},s.prototype.getOnComplete=function(){return this._onComplete},s.prototype.getOnFailure=function(){return this._onFailure},s.prototype.getOnReceive=function(){return this._onReceive},s.prototype.getOnSuccess=function(){return this._onSuccess},s.prototype.getOnUserClientJoin=function(){return this._onUserClientJoin},s.prototype.getOnUserClientLeave=function(){return this._onUserClientLeave},s.prototype.getOnUserJoin=function(){return this._onUserJoin},s.prototype.getOnUserLeave=function(){return this._onUserLeave},s.prototype.getRejoin=function(){return this._rejoin},s.prototype.getTag=function(){var e;return null!=(e=fm.serializer.deserializeString(this.getExtensionValueJson("fm.tag")))?e:fm.stringExtensions.empty},s.prototype.getUserId=function(){return this._userId},s.prototype.getUserNickname=function(){return this._userNickname},s.prototype.setChannel=function(){var e;return e=arguments[0],this.__channels=fm.websync.extensible.sharedSetChannel(e)},s.prototype.setChannels=function(){var e;return e=arguments[0],this.__channels=fm.websync.extensible.sharedSetChannels(e)},s.prototype.setOnComplete=function(){var e;return e=arguments[0],this._onComplete=e},s.prototype.setOnFailure=function(){var e;return e=arguments[0],this._onFailure=e},s.prototype.setOnReceive=function(){var e;return e=arguments[0],this._onReceive=e},s.prototype.setOnSuccess=function(){var e;return e=arguments[0],this._onSuccess=e},s.prototype.setOnUserClientJoin=function(){var e;return e=arguments[0],this._onUserClientJoin=e},s.prototype.setOnUserClientLeave=function(){var e;return e=arguments[0],this._onUserClientLeave=e},s.prototype.setOnUserJoin=function(){var e;return e=arguments[0],this._onUserJoin=e},s.prototype.setOnUserLeave=function(){var e;return e=arguments[0],this._onUserLeave=e},s.prototype.setRejoin=function(){var e;return e=arguments[0],this._rejoin=e},s.prototype.setTag=function(){var e;return e=arguments[0],this.setExtensionValueJson("fm.tag",fm.serializer.serializeString(null!=e?e:fm.stringExtensions.empty),!1)},s.prototype.setUserId=function(){var e;return e=arguments[0],this._userId=e},s.prototype.setUserNickname=function(){var e;return e=arguments[0],this._userNickname=e},s}(fm.websync.baseInputArgs);var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function s(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return s.prototype=t.prototype,e.prototype=new s,e.__super__=t.prototype,e},n={}.hasOwnProperty;fm.websync.chat.joinState=function(n){function s(){this.updateSubscribeSuccess=e(this.updateSubscribeSuccess,this),this.updateSubscribeFailure=e(this.updateSubscribeFailure,this),this.updateBindSuccess=e(this.updateBindSuccess,this),this.updateBindFailure=e(this.updateBindFailure,this),this.setSubscribeSuccessArgs=e(this.setSubscribeSuccessArgs,this),this.setSubscribeSuccess=e(this.setSubscribeSuccess,this),this.setSubscribeFailureArgs=e(this.setSubscribeFailureArgs,this),this.setBindSuccessArgs=e(this.setBindSuccessArgs,this),this.setBindSuccess=e(this.setBindSuccess,this),this.setBindFailureArgs=e(this.setBindFailureArgs,this),this.getSubscribeSuccessArgs=e(this.getSubscribeSuccessArgs,this),this.getSubscribeSuccess=e(this.getSubscribeSuccess,this),this.getSubscribeFailureArgs=e(this.getSubscribeFailureArgs,this),this.getBindSuccessArgs=e(this.getBindSuccessArgs,this),this.getBindSuccess=e(this.getBindSuccess,this),this.getBindFailureArgs=e(this.getBindFailureArgs,this);var t;return 1===arguments.length&&fm.util.isPlainObject(arguments[0])?(t=s.__super__.constructor.call(this),fm.util.attachProperties(this,arguments[0]),t):t=s.__super__.constructor.call(this)}return t(s,n),s.prototype._bindFailureArgs=null,s.prototype._bindSuccess=!1,s.prototype._bindSuccessArgs=null,s.prototype._subscribeFailureArgs=null,s.prototype._subscribeSuccess=!1,s.prototype._subscribeSuccessArgs=null,s.prototype.getBindFailureArgs=function(){return this._bindFailureArgs},s.prototype.getBindSuccess=function(){return this._bindSuccess},s.prototype.getBindSuccessArgs=function(){return this._bindSuccessArgs},s.prototype.getSubscribeFailureArgs=function(){return this._subscribeFailureArgs},s.prototype.getSubscribeSuccess=function(){return this._subscribeSuccess},s.prototype.getSubscribeSuccessArgs=function(){return this._subscribeSuccessArgs},s.prototype.setBindFailureArgs=function(){var e;return e=arguments[0],this._bindFailureArgs=e},s.prototype.setBindSuccess=function(){var e;return e=arguments[0],this._bindSuccess=e},s.prototype.setBindSuccessArgs=function(){var e;return e=arguments[0],this._bindSuccessArgs=e},s.prototype.setSubscribeFailureArgs=function(){var e;return e=arguments[0],this._subscribeFailureArgs=e},s.prototype.setSubscribeSuccess=function(){var e;return e=arguments[0],this._subscribeSuccess=e},s.prototype.setSubscribeSuccessArgs=function(){var e;return e=arguments[0],this._subscribeSuccessArgs=e},s.prototype.updateBindFailure=function(){var e;return e=arguments[0],this.setBindSuccess(!1),this.setBindFailureArgs(e)},s.prototype.updateBindSuccess=function(){var e;return e=arguments[0],this.setBindSuccess(!0),this.setBindSuccessArgs(e)},s.prototype.updateSubscribeFailure=function(){var e;return e=arguments[0],this.setSubscribeSuccess(!1),this.setSubscribeFailureArgs(e)},s.prototype.updateSubscribeSuccess=function(){var e;return e=arguments[0],this.setSubscribeSuccess(!0),this.setSubscribeSuccessArgs(e)},s}(fm.object);var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function s(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return s.prototype=t.prototype,e.prototype=new s,e.__super__=t.prototype,e},n={}.hasOwnProperty;fm.websync.chat.userJoinArgs=function(n){function s(){this.getUserNickname=e(this.getUserNickname,this),this.getUserId=e(this.getUserId,this),this.getJoinedUser=e(this.getJoinedUser,this);var t,n,r;return 1===arguments.length&&fm.util.isPlainObject(arguments[0])?(n=s.__super__.constructor.call(this),fm.util.attachProperties(this,arguments[0]),n):(t=arguments[0],r=arguments[1],n=s.__super__.constructor.call(this,t,r))}return t(s,n),s.prototype.__joinedUser=null,s.prototype.__userId=null,s.prototype.__userNickname=null,s.prototype.getJoinedUser=function(){return this.__joinedUser},s.prototype.getUserId=function(){return this.__userId},s.prototype.getUserNickname=function(){return this.__userNickname},s}(fm.websync.subscribers.clientSubscribeArgs);var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function s(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return s.prototype=t.prototype,e.prototype=new s,e.__super__=t.prototype,e},n={}.hasOwnProperty;fm.websync.chat.userLeaveArgs=function(n){function s(){this.getUserNickname=e(this.getUserNickname,this),this.getUserId=e(this.getUserId,this),this.getLeftUser=e(this.getLeftUser,this);var t,n,r;return 1===arguments.length&&fm.util.isPlainObject(arguments[0])?(n=s.__super__.constructor.call(this),fm.util.attachProperties(this,arguments[0]),n):(t=arguments[0],r=arguments[1],n=s.__super__.constructor.call(this,t,r))}return t(s,n),s.prototype.__leftUser=null,s.prototype.__userId=null,s.prototype.__userNickname=null,s.prototype.getLeftUser=function(){return this.__leftUser},s.prototype.getUserId=function(){return this.__userId},s.prototype.getUserNickname=function(){return this.__userNickname},s}(fm.websync.subscribers.clientUnsubscribeArgs);var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function s(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return s.prototype=t.prototype,e.prototype=new s,e.__super__=t.prototype,e},n={}.hasOwnProperty;fm.websync.chat.leaveArgs=function(n){function s(){this.setTag=e(this.setTag,this),this.setOnSuccess=e(this.setOnSuccess,this),this.setOnFailure=e(this.setOnFailure,this),this.setOnComplete=e(this.setOnComplete,this),this.setChannels=e(this.setChannels,this),this.setChannel=e(this.setChannel,this),this.getTag=e(this.getTag,this),this.getOnSuccess=e(this.getOnSuccess,this),this.getOnFailure=e(this.getOnFailure,this),this.getOnComplete=e(this.getOnComplete,this),this.getChannels=e(this.getChannels,this),this.getChannel=e(this.getChannel,this);var t,n,r;return 1===arguments.length&&fm.util.isPlainObject(arguments[0])?(n=s.__super__.constructor.call(this),fm.util.attachProperties(this,arguments[0]),n):2===arguments.length?(t=arguments[0],r=arguments[1],n=s.__super__.constructor.call(this),this.setChannels(t),this.setTag(r),n):1===arguments.length?(t=arguments[0],n=s.__super__.constructor.call(this),this.setChannels(t),n):void 0}return t(s,n),s.prototype.__channels=null,s.prototype._onComplete=null,s.prototype._onFailure=null,s.prototype._onSuccess=null,s.prototype.getChannel=function(){return fm.websync.extensible.sharedGetChannel(this.__channels)},s.prototype.getChannels=function(){return fm.websync.extensible.sharedGetChannels(this.__channels)},s.prototype.getOnComplete=function(){return this._onComplete},s.prototype.getOnFailure=function(){return this._onFailure},s.prototype.getOnSuccess=function(){return this._onSuccess},s.prototype.getTag=function(){var e;return null!=(e=fm.serializer.deserializeString(this.getExtensionValueJson("fm.tag")))?e:fm.stringExtensions.empty},s.prototype.setChannel=function(){var e;return e=arguments[0],this.__channels=fm.websync.extensible.sharedSetChannel(e)},s.prototype.setChannels=function(){var e;return e=arguments[0],this.__channels=fm.websync.extensible.sharedSetChannels(e)},s.prototype.setOnComplete=function(){var e;return e=arguments[0],this._onComplete=e},s.prototype.setOnFailure=function(){var e;return e=arguments[0],this._onFailure=e},s.prototype.setOnSuccess=function(){var e;return e=arguments[0],this._onSuccess=e},s.prototype.setTag=function(){var e;return e=arguments[0],this.setExtensionValueJson("fm.tag",fm.serializer.serializeString(null!=e?e:fm.stringExtensions.empty),!1)},s}(fm.websync.baseInputArgs);var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function s(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return s.prototype=t.prototype,e.prototype=new s,e.__super__=t.prototype,e},n={}.hasOwnProperty;fm.websync.chat.joinCompleteArgs=function(n){function s(){this.getIsRejoin=e(this.getIsRejoin,this);var t;return 1===arguments.length&&fm.util.isPlainObject(arguments[0])?(t=s.__super__.constructor.call(this),fm.util.attachProperties(this,arguments[0]),t):t=s.__super__.constructor.call(this)}return t(s,n),s.prototype.__isRejoin=!1,s.prototype.getIsRejoin=function(){return this.__isRejoin},s}(fm.websync.baseCompleteArgs);var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function s(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return s.prototype=t.prototype,e.prototype=new s,e.__super__=t.prototype,e},n={}.hasOwnProperty;fm.websync.chat.joinFailureArgs=function(n){function s(){this.getUserNickname=e(this.getUserNickname,this),this.getUserId=e(this.getUserId,this),this.getTag=e(this.getTag,this),this.getIsRejoin=e(this.getIsRejoin,this),this.getChannels=e(this.getChannels,this),this.getChannel=e(this.getChannel,this);var t;return 1===arguments.length&&fm.util.isPlainObject(arguments[0])?(t=s.__super__.constructor.call(this),fm.util.attachProperties(this,arguments[0]),t):t=s.__super__.constructor.call(this)}return t(s,n),s.prototype.__channels=null,s.prototype.__isRejoin=!1,s.prototype.__userId=null,s.prototype.__userNickname=null,s.prototype.getChannel=function(){return fm.websync.extensible.sharedGetChannel(this.__channels)},s.prototype.getChannels=function(){return fm.websync.extensible.sharedGetChannels(this.__channels)},s.prototype.getIsRejoin=function(){return this.__isRejoin},s.prototype.getTag=function(){var e;return null!=(e=fm.serializer.deserializeString(this.getExtensionValueJson("fm.tag")))?e:fm.stringExtensions.empty},s.prototype.getUserId=function(){return this.__userId},s.prototype.getUserNickname=function(){return this.__userNickname},s}(fm.websync.baseFailureArgs);var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function s(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return s.prototype=t.prototype,e.prototype=new s,e.__super__=t.prototype,e},n={}.hasOwnProperty;fm.websync.chat.joinSuccessArgs=function(n){function s(){this.getUsers=e(this.getUsers,this),this.getUserNickname=e(this.getUserNickname,this),this.getUserId=e(this.getUserId,this),this.getTag=e(this.getTag,this),this.getIsRejoin=e(this.getIsRejoin,this),this.getChannels=e(this.getChannels,this),this.getChannel=e(this.getChannel,this);var t;return 1===arguments.length&&fm.util.isPlainObject(arguments[0])?(t=s.__super__.constructor.call(this),fm.util.attachProperties(this,arguments[0]),t):t=s.__super__.constructor.call(this)}return t(s,n),s.prototype.__channels=null,s.prototype.__isRejoin=!1,s.prototype.__userId=null,s.prototype.__userNickname=null,s.prototype.__users=null,s.prototype.getChannel=function(){return fm.websync.extensible.sharedGetChannel(this.__channels)},s.prototype.getChannels=function(){return fm.websync.extensible.sharedGetChannels(this.__channels)},s.prototype.getIsRejoin=function(){return this.__isRejoin},s.prototype.getTag=function(){var e;return null!=(e=fm.serializer.deserializeString(this.getExtensionValueJson("fm.tag")))?e:fm.stringExtensions.empty},s.prototype.getUserId=function(){return this.__userId},s.prototype.getUserNickname=function(){return this.__userNickname},s.prototype.getUsers=function(){return this.__users},s}(fm.websync.baseSuccessArgs);var t=function(e,t){function s(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return s.prototype=t.prototype,e.prototype=new s,e.__super__=t.prototype,e},n={}.hasOwnProperty;fm.websync.chat.leaveCompleteArgs=function(e){function n(){var e;return 1===arguments.length&&fm.util.isPlainObject(arguments[0])?(e=n.__super__.constructor.call(this),fm.util.attachProperties(this,arguments[0]),e):e=n.__super__.constructor.call(this)}return t(n,e),n}(fm.websync.baseCompleteArgs);var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function s(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return s.prototype=t.prototype,e.prototype=new s,e.__super__=t.prototype,e},n={}.hasOwnProperty;fm.websync.chat.leaveFailureArgs=function(n){function s(){this.getUserNickname=e(this.getUserNickname,this),this.getUserId=e(this.getUserId,this),this.getTag=e(this.getTag,this),this.getChannels=e(this.getChannels,this),this.getChannel=e(this.getChannel,this);var t;return 1===arguments.length&&fm.util.isPlainObject(arguments[0])?(t=s.__super__.constructor.call(this),fm.util.attachProperties(this,arguments[0]),t):t=s.__super__.constructor.call(this)}return t(s,n),s.prototype.__channels=null,s.prototype.__userId=null,s.prototype.__userNickname=null,s.prototype.getChannel=function(){return fm.websync.extensible.sharedGetChannel(this.__channels)},s.prototype.getChannels=function(){return fm.websync.extensible.sharedGetChannels(this.__channels)},s.prototype.getTag=function(){var e;return null!=(e=fm.serializer.deserializeString(this.getExtensionValueJson("fm.tag")))?e:fm.stringExtensions.empty},s.prototype.getUserId=function(){return this.__userId},s.prototype.getUserNickname=function(){return this.__userNickname},s}(fm.websync.baseFailureArgs);var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function s(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return s.prototype=t.prototype,e.prototype=new s,e.__super__=t.prototype,e},n={}.hasOwnProperty;fm.websync.chat.leaveSuccessArgs=function(n){function s(){this.getUserNickname=e(this.getUserNickname,this),this.getUserId=e(this.getUserId,this),this.getTag=e(this.getTag,this),this.getChannels=e(this.getChannels,this),this.getChannel=e(this.getChannel,this);var t;return 1===arguments.length&&fm.util.isPlainObject(arguments[0])?(t=s.__super__.constructor.call(this),fm.util.attachProperties(this,arguments[0]),t):t=s.__super__.constructor.call(this)}return t(s,n),s.prototype.__channels=null,s.prototype.__userId=null,s.prototype.__userNickname=null,s.prototype.getChannel=function(){return fm.websync.extensible.sharedGetChannel(this.__channels)},s.prototype.getChannels=function(){return fm.websync.extensible.sharedGetChannels(this.__channels)},s.prototype.getTag=function(){var e;return null!=(e=fm.serializer.deserializeString(this.getExtensionValueJson("fm.tag")))?e:fm.stringExtensions.empty},s.prototype.getUserId=function(){return this.__userId},s.prototype.getUserNickname=function(){return this.__userNickname},s}(fm.websync.baseSuccessArgs);var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function s(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return s.prototype=t.prototype,e.prototype=new s,e.__super__=t.prototype,e},n={}.hasOwnProperty;fm.websync.chat.joinReceiveArgs=function(n){function s(){this.getUserNickname=e(this.getUserNickname,this),this.getUserId=e(this.getUserId,this),this.getPublishingUser=e(this.getPublishingUser,this);var t,n,r,i,o,a;return 1===arguments.length&&fm.util.isPlainObject(arguments[0])?(o=s.__super__.constructor.call(this),fm.util.attachProperties(this,arguments[0]),o):(t=arguments[0],i=arguments[1],r=arguments[2],n=arguments[3],a=arguments[4],o=s.__super__.constructor.call(this,t,i,r,n,a))}return t(s,n),s.prototype.__publishingUser=null,s.prototype.__userId=null,s.prototype.__userNickname=null,s.prototype.getPublishingUser=function(){return this.__publishingUser},s.prototype.getUserId=function(){return this.__userId},s.prototype.getUserNickname=function(){return this.__userNickname},s}(fm.websync.subscribeReceiveArgs);var s,r,i,o,a;for(a=["join","leave"],s=function(e){var t;return t=fm.websync.client.prototype[e],fm.websync.client.prototype[e]=function(){var n;return 1===arguments.length&&fm.util.isPlainObject(arguments[0])?(n=arguments[0],t.call(this,new fm.websync.chat[e+"Args"](n))):t.apply(this,arguments)}},r=0,i=a.length;i>r;r++)o=a[r],s(o);return fm.websync.chat});